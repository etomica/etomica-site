<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset='utf-8'>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>LJ EOS</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <link href='main.css' rel='stylesheet'>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/brython@3.10.3/brython.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/brython@3.10.3/brython_stdlib.js"></script>
    <script type='text/javascript' src='util.js'></script>
    <script src="https://cdn.plot.ly/plotly-2.11.1.min.js"></script>
    <script src="https://kit.fontawesome.com/7f972bf8c7.js" crossorigin="anonymous"></script>
  </head>
  <body onload='brython()'>
    <script type='text/javascript'>
document.title = "LJ EOS for FCC";
function myUpdatePlot() {
  updatePlot();
}

      window.addEventListener("load", function() {
          document.getElementById("checkNrho").parentNode.style.display = "block";
          updateRhoP();
          updateX();
        var plotModalEl = document.getElementById("plotModal");
        plotModalEl.addEventListener("show.bs.modal", myUpdatePlot);
      });

    </script>
    <script type='text/python' src='LJ_EOS.py'></script>
    <script type='text/python' src='EOS_util.py'></script>
    <script type='text/python'>
      from browser import document, window, timer
      from browser.widgets.dialog import InfoDialog
      from LJ_EOS import getEOS
      from EOS_util import optsForPhase

      def gimmeRhoFCC(T, rhostr, Pstr, x, eos, doc):
        if doc["checkP"].checked:
          P = eval(Pstr)
          rho = eos.rhoForProps(T, {'P': P})
        elif doc["checkNrho"].checked:
          rho = eval(rhostr)
          rho = eos.latRhoForNRho(T, rho)
        else:
          rho = eval(rhostr)
        return rho

      thisGimmeRho = gimmeRhoFCC
      phaseName = "fcc"

      myInterval = None
      ix = 0

      def doOnePoint(stuff):
        global myInterval, ix, thisGimmeRho
        doc,eos,myGimmeRho = stuff
        try:
          numX = int(doc["inputXnum"].value)
        except ValueError:
          InfoDialog("Trouble", f"Must provide a valid # of x points")
          stopUpdate()
          return
        if ix > numX:
          stopUpdate()
        x = ix / numX
        ix = ix + 1
        Tstr = doc['inputT'].value
        Pstr = doc['inputP'].value
        rhostr = doc['inputRho'].value
        T = eval(Tstr)
        rho = myGimmeRho(T, rhostr, Pstr, x, eos, doc)
        props = eos.eval(T,rho)
        window.addParametricRow(T, rho, props)
        if ix > numX:
          stopUpdate()

      def stopUpdate():
        global myInterval
        timer.clear_interval(myInterval)
        document["btnUpdate"].textContent = "Update"
        myInterval = None
        print("stopped")

      def update(ev):
        global myInterval, ix, phaseName
        if not myInterval == None:
          stopUpdate()
          return
        window.clearAllSimple()

        B3callback = None
        if 'grabB3' in window:
          B3callback = window.grabB3

        opts = optsForPhase(phaseName, document, B3callback)
        eos = getEOS(phaseName, opts)

        useX = document["checkX"].checked
        if useX:
          document["btnUpdate"].textContent = "Stop"
          ix = 0
          try:
            numX = int(document["inputXnum"].value)
          except ValueError:
            InfoDialog("Trouble", f"Must provide a valid # of x points")
            return
          if numX < 1:
            InfoDialog("Trouble", f"Need at least 1 x value")
            return
          myInterval = timer.set_interval(doOnePoint, 0, [document,eos,thisGimmeRho])
          return

        Tstr = document['inputT'].value
        Pstr = document['inputP'].value
        rhostr = document['inputRho'].value

        try:
          T = float(Tstr)
        except ValueError:
          InfoDialog("Trouble", f"Must provide a valid temperature")
          return
        rho = thisGimmeRho(T, rhostr, Pstr, 0, eos, document)
        props = eos.eval(T,rho)
        window.showResults(T, rho, props)

      document["btnUpdate"].bind("click", update)

    </script>

    <div class='container'>
      <h1 class='h2'><a href='index.html'><i class="fa-solid fa-house"></i></a> Equation of State for FCC phase of LJ</h1>

      <div id='parametersDiv' class='card mb-4'>
        <div id='headingParameters' class='card-header' role='tab'>
          <h2 class='h5 mb-0'>State Condition</a></h2>
        </div>
        <div class='show' aria-labelledby='headingParameters'>
          <div class='card-body'>
            <div class='row'>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputT' class='col-form-label'>T</label>
                  </div>
                  <div class='col-auto'>
                    <input type='text' id='inputT' class='form-control'>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputRho' class='col-form-label'>&rho;</label>
                  </div>
                  <div class='col-auto'>
                    <input type='text' id='inputRho' class='form-control'>
                  </div>
                  <div class='col-auto' class=form-check' style='display: none'>
                    <input class='form-check-input' type='checkbox' value='' id='checkNrho'>
                    <label class='form-check-label' for='checkNrho' data-bs-toggle="tooltip" data-bs-placement="right" title="given density will be imposed as atomic rather than as a site density">atom density</label>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputP' class='col-form-label'>P</label>
                  </div>
                  <div class='col-auto'>
                    <input type='text' id='inputP' class='form-control' disabled>
                  </div>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkP' onclick='updateRhoP()'>
                    <label class='form-check-label' for='checkP'>compute &rho; for P</label>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputXnum' class='col-form-label'>#</label>
                  </div>
                  <div class='col-auto'>
                    <input type='text' id='inputXnum' class='form-control' disabled placeholder='# of x values'>
                  </div>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkX' onclick='updateX()'>
                    <label class='form-check-label' for='checkX' data-bs-toggle="tooltip" data-bs-placement="right" title="T, rho, P will vary parametrically as a function of x.  The number of points is given here.  T, rho and P can be simple (1+x) or more complex python expressions (1-math.exp(x))">use T(x), &rho;(x) P(x) (0&lt;=x&lt;=1)</label>
                  </div>
                </div>
              </div>
            </div>
            <div class='row g-3 py-1 align-items-center'>
              <div class='col-auto'>
                <button id='btnUpdate' class='btn btn-sm btn-primary' type='button'>Update</button>
                <button id='btnDoc' class='btn btn-sm btn-info' type='button' data-content='EOS' data-bs-toggle="modal" data-bs-target="#infoModal">Info</button>
              </div>
            </div>
          </div>
        </div>
      </div>

    <div class="modal fade" id="infoModal" tabindex="-1" aria-labelledby="infoModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="infoModalLabel">Info</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <p>All info: <select class='form-select' style='width: auto; display: inline-block' id='info-modal-select'></select>
            <div id='infoModalBody'></div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>

      <div id='parametersDiv-fcc' class='card mb-4'>
        <div id='headingParameters-fcc' class='card-header' role='tab'>
          <h2 class='h5 mb-0'><a role='button' data-bs-toggle='collapse' href='#collapseparametersDiv-fcc' aria-expanded='true' aria-controls='colapseparametersDiv-fcc'>FCC Parameters</a></h2>
        </div>
        <div id='collapseparametersDiv-fcc' class='collapse show' role='tabpanel' aria-labelledby='headingParameters-fcc'>
          <div class='card-body'>
            <div class='row'>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputEOS-fcc' class='col-form-label'>EOS</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputEOS-fcc' onchange='phaseChoiceUpdated("fcc")'>
                      <option value='Schultz' selected>Schultz</option>
                      <option value='Adidharma'>Adidharma</option>
                      <option value='dePablo'>de Pablo</option>
                      <option value='vdh'>van der Hoef</option>
                    </select>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkLat-fcc'>
                    <label class='form-check-label' for='checkLat-fcc'>lattice properties</label>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkHarmonic-fcc'>
                    <label class='form-check-label' for='checkHarmonic-fcc'>lattice+harmonic properties</label>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkVac-fcc' onchange='updateVacancyCitation()'>
                    <label class='form-check-label' for='checkVac-fcc' data-bs-toggle="tooltip" data-bs-placement="right" title="include contribution to thermodynamic properties due to the existence of lattice vacancies">include vacancies</label>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputNf' class='col-form-label' data-bs-toggle="tooltip" data-bs-placement="top" title="# of atoms used for molecular simulations and lattice dynamics"># of atoms</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputNf'>
                      <option value='0' selected>&infin;</option>
                      <option value='4000'>4000</option>
                      <option value='2048'>2048</option>
                      <option value='864'>864</option>
                      <option value='500'>500</option>
                      <option value='256'>256</option>
                    </select>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='rc-fcc' class='col-form-label' data-bs-toggle="tooltip" data-bs-placement="top" data-bs-html="true" title="use EOS for the given scaled potential truncation (r<sub>c</sub> &rho;<sup>-1/3</sup>); can be corrected by long-range correction (LRC)">cutoff</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputRc-fcc'>
                      <option value='0' selected>&infin;</option>
                      <option value='11'>11</option>
                      <option value='9'>9</option>
                      <option value='7.5'>7.5</option>
                      <option value='6'>6</option>
                      <option value='5'>5</option>
                      <option value='4'>4</option>
                      <option value='3.5'>3.5</option>
                      <option value='3'>3</option>
                    </select>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkNrcc-fcc'>
                    <label class='form-check-label' for='checkNrcc-fcc' data-bs-toggle="tooltip" data-bs-placement="right" title="Lattice and harmonic contributions will be taken from untruncated estimates">apply only to anharmonic</label>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkLRC-fcc'>
                    <label class='form-check-label' for='checkLRC-fcc' data-bs-toggle="tooltip" data-bs-placement="right" title="Include standard long-range correction for potential truncation.  This should not be used in conjunction with 'apply only to anharmonic' as the standard LRC primarily corrects the lattice energy">include LRC</label>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='citation' id='fcc-ref-Schultz'>EOS Citations: A. J. Schultz, D. A. Kofke, "<a href='https://doi.org/10.1063/1.5053714'>Comprehensive high-precision high-accuracy equation of state and coexistence properties for classical Lennard-Jones crystals and low-temperature fluid phases</a>", <span class='pubName'>J. Chem. Phys.</span> <span class='volume'>149</span>, 204508 (2018)<span style='display: none;' id='vacancy-citation'>; A. Purohit, A. J. Schultz, S. G. Moustafa, J. R. Errington, D. A. Kofke, "<a href='https://doi.org/10.1080/00268976.2018.1481542'>Free energy and concentration of crystalline vacancies by molecular simulation</a>", Mol. Phys. 116, 3027-3041 (2018)</span>.</div>
                  <div class='citation' id='fcc-ref-Adidharma'>EOS Citation: H. Adidharma and S. P. Tan, "<a href='https://doi.org/10.1063/1.4955061'>Accurate Monte Carlo simulations on FCC and HCP Lennard-Jones solids at very low temperatures and high reduced densities up to 1.30</a>", <span class='pubName'>J. Chem. Phys.</span> <span class='volume'>145</span>, 014503 (2016).</div>
                  <div class='citation' id='fcc-ref-dePablo'>EOS Citation: E. A. Mastny and J. J. de Pablo, "<a href='https://doi.org/10.1063/1.2753149'>Melting line of the Lennard-Jones system, infinite size, and full potential</a>", <span class='pubName'>J. Chem. Phys.</span> <span class='volume'>127</span>, 104504 (2007).</div>
                  <div class='citation' id='fcc-ref-vdh'>EOS Citation: M. A. van der Hoef, "<a href='https://doi.org/10.1063/1.1314342'>Free energy of the Lennard-Jones solid</a>", <span class='pubName'>J. Chem.  Phys.</span> <span class='volume'>113</span>, 8142 (2000).</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div id='resultsDiv' class='card'>
        <div id='headingResults' class='card-header' role='tab'>
          <h2 class='h5 mb-0' style='float: left'>Results</a></h2>
          <button class='btn btn-info btn-sm' style='float: right' onclick='copyToClipboard(copyText)' id='copyBtn'>Copy</button>
          <button class='btn btn-info btn-sm' style='margin-right: 1rem; float: right' id='plotBtn' data-bs-toggle="modal" data-bs-target="#plotModal">Plot</button>
        </div>
        <div class='show' aria-labelledby='headingResults'>
          <div class='card-body'>
            <div id='singleResultsDiv'>
              <p id='T_row'>T: <span id='T'></span></p>
              <p id='rho_row'>&rho;: <span id='rho'></span></p>
              <p id='P_row'>P: <span id='P'></span></p>
              <p id='U_row'>U: <span id='U'></span></p>
              <p id='A_row'>A: <span id='A'></span></p>
              <p id='G_row'>G: <span id='G'></span></p>
              <p id='Z_row'>Z: <span id='Z'></span></p>
              <p id='Cv_row'>Cv: <span id='Cv'></span></p>
              <p id='phi_row'>&phi;: <span id='phi'></span></p>
              <p id='alpha_row'>&alpha;: <span id='alpha'></span></p>
            </div>
            <div class='overflow-auto' id='parametricResultsDiv' style='display: none;'>
              <table class='table small'>
                <thead><tr id='parametricTH'><th id='T_col'>T</th><th id='rho_col'>&rho;</th><th id='P_col'>P</th><th id='U_col'>U</th><th id='A_col'>A</th><th id='G_col'>G</th><th id='Z_col'>Z</th><th id='Cv_col'>Cv</th><th id='phi_col'>&phi;</th><th id='alpha_col'>&alpha;</th></tr></thead>
                <tbody id='parametricResults'></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

    <div class="modal fade" id="plotModal" tabindex="-1" aria-labelledby="plotModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="plotModalLabel">Plot</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div id="plotDiv"></div>
            <div class='row'>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputXprop' class='col-form-label'>X:</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputXprop' onchange='myUpdatePlot()'>
                      <option value='T'>T</option>
                      <option value='rho' selected>&rho;</option>
                      <option value='P'>P</option>
                      <option value='U'>U</option>
                      <option value='A'>A</option>
                      <option value='G'>G</option>
                      <option value='Z'>Z</option>
                      <option value='Cv'>Cv</option>
                      <option value='phi'>&phi;</option>
                      <option value='alpha'>&alpha;</option>
                      <option value='v2'>v2</option>
                      <option value='Y'>Y</option>
                      <option value='H'>H</option>
                      <option value='S'>S</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputYprop' class='col-form-label'>Y:</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputYprop' onchange='myUpdatePlot()'>
                      <option value='T'>T</option>
                      <option value='rho'>&rho;</option>
                      <option value='P' selected>P</option>
                      <option value='U'>U</option>
                      <option value='A'>A</option>
                      <option value='G'>G</option>
                      <option value='Z'>Z</option>
                      <option value='Cv'>Cv</option>
                      <option value='phi'>&phi;</option>
                      <option value='alpha'>&alpha;</option>
                      <option value='v2'>v2</option>
                      <option value='Y'>Y</option>
                      <option value='H'>H</option>
                      <option value='S'>S</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='plotXDiff' onchange='myUpdatePlot()'>
                    <label class='form-check-label' for='plotXDiff' data-bs-toggle="tooltip" data-bs-placement="right" title="Plot a single set as the value for phase2 - phase1 instead of separate sets">X diff</label>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='plotYDiff' onchange='myUpdatePlot()'>
                    <label class='form-check-label' for='plotYDiff' data-bs-toggle="tooltip" data-bs-placement="right" title="Plot a single set as the value for phase2 - phase1 instead of separate sets">Y diff</label>
                  </div>
                </div>
              </div>
            </div>
            <div class='row'>
              <div class='col-auto px-4' style='display: none;' id='SLE-Tmax-div'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputTMax' class='col-form-label'>T<sub>max</sub></label>
                  </div>
                  <div class='col-auto'>
                    <input type='text' id='inputTMax' class='form-control' value='2' style='width: 4rem;' onchange='myUpdatePlot()'>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4' style='display: none;' id='SLE-rhomax-div'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputRhoMax' class='col-form-label'>&rho;<sub>max</sub></label>
                  </div>
                  <div class='col-auto'>
                    <input type='text' id='inputRhoMax' class='form-control' value='1.5' style='width: 4rem;' onchange='myUpdatePlot()'>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4' style='display: none;' id='tie-lines-div'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputNTieLines' class='col-form-label' data-bs-toggle="tooltip" data-bs-placement="bottom" title="tie lines will be drawn between coexisting points"># tie lines</label>
                  </div>
                  <div class='col-auto'>
                    <input type='text' id='inputNTieLines' class='form-control' value='0' style='width: 3rem;' onchange='myUpdatePlot()'>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
