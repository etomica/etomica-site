<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset='utf-8'>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>LJ EOS</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <link href='main.css' rel='stylesheet'>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/brython@3.10.3/brython.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/brython@3.10.3/brython_stdlib.js"></script>
    <script type='text/javascript' src='util.js'></script>
    <script src="https://cdn.plot.ly/plotly-2.11.1.min.js"></script>
    <script src="https://kit.fontawesome.com/7f972bf8c7.js" crossorigin="anonymous"></script>
  </head>
    <script>
document.title = "Vapor-Solid Phase Coexistence for LJ";
function myPhasesUpdated() {
  var phase2 = document.getElementById("phase2").value;
  if (phase2 == "fcc") {
    document.getElementById("tabulateCorDiff").removeAttribute("disabled");
  }
  else {
    document.getElementById("tabulateCorDiff").setAttribute("disabled","true");
  }
  phasesUpdated();
}

      function myUpdatePlot() {
        var xsets = document.getElementById("plotXDiff").checked ? "diff" : "auto";
        var ysets = document.getElementById("plotYDiff").checked ? "diff" : "auto";
        var phase2 = document.getElementById("phase2").value;
        updatePlotCoex("vapor", phase2, Infinity, Infinity, xsets, ysets);
      }
      window.addEventListener("load", function() {
        document.getElementById("subtractCorCheckboxDiv").style.display = "block";
        document.getElementById("tie-lines-div").style.display = "block";
        document.getElementById("plot-cor-div").style.display = "block";
        var plotModalEl = document.getElementById("plotModal");
        plotModalEl.addEventListener("show.bs.modal", myUpdatePlot);
      });
function clearAllRows() {
  var tbody = document.getElementById("coex-table");
  empty(tbody);
}

var allData = [], allCorrelations = {}, tableCorrelationData = [];
var tableCor = "Schultz";

function makeTableData(i) {
  var iData = allData[i];
  var G = isNaN(iData.props1.G) ? iData.props2.G : iData.props1.G;
  var v = [iData.T, iData.props1['rho'], iData.props2['rho'], iData.props1['P'], G];
  v.push('phi' in iData.props2 ? iData.props2.phi : 0);
  if (document.getElementById("tabulateCorDiff").checked) {
    var cprops1 = allCorrelations[tableCor][i].props1;
    var cprops2 = allCorrelations[tableCor][i].props2;
    v = [iData.T,
      iData.props1['rho']-cprops1['rho'], iData.props2['rho']-cprops2['rho'],
      iData.props1['P']-cprops1['P'], G-cprops1['G']];
    v.push('phi' in iData.props2 ? '-' : 0);
  }
  return v;
}
function addRow(T, props1, props2, correlations) {
  var tbody = document.getElementById("coex-table");
  props1.v2 = 1/(props1.rho*props1.rho);
  props2.v2 = 1/(props2.rho*props2.rho);
  props1.Y = (T/4)*Math.pow(props1.rho,-4);
  props2.Y = (T/4)*Math.pow(props2.rho,-4);
  allData.push({T: T, props1: props1, props2: props2});
  for (var c in correlations) {
    if (!(c in allCorrelations)) allCorrelations[c] = [];
    var iCor = correlations[c];
    iCor.props1.v2 = 1/(iCor.props1.rho*iCor.props1.rho);
    iCor.props2.v2 = 1/(iCor.props2.rho*iCor.props2.rho);
    iCor.props1.Y = (T/4)*Math.pow(iCor.props1.rho,-4);
    iCor.props2.Y = (T/4)*Math.pow(iCor.props2.rho,-4);
    allCorrelations[c].push({T: T, props1: iCor.props1, props2: iCor.props2});
    if (c == tableCor) {
      var vCor = [T, iCor.props1['rho'], iCor.props2['rho'], iCor.props1['P'], iCor.props1['G']];
      vCor.push('phi' in iCor.props2 ? iCor.props2.phi : 0);
      tableCorrelationData.push(vCor);
    }
  }
  tbody.appendChild(makeTableRow(allData.length-1));
}
  
window.addEventListener("load", myPhasesUpdated);
    </script>
  </head>
  <body>
    <script type='text/python' src='LJ_EOS.py'></script>
    <script type='text/python' src='EOS_util.py'></script>
    <script type='text/python'>
      from browser import document, window, timer
      window.removeBrythonSpinner()
      from browser.widgets.dialog import InfoDialog
      from LJ_EOS import getEOS, findCoexistence
      from EOS_util import optsForPhase, CoexCorrelator

      eos1 = eos2 = myInterval = correlator = None
      T = Pguess = 0
      success = False

      def doOneCoex():
        global eos1, eos2, myInterval, iT, Pguess, correlator, success
        if not success:
          InfoDialog("Trouble", f"Unknown trouble.  Stopping")
          stopUpdate()
          return
        success = False
        if iT > 150:
          success = True
          stopUpdate()
          return
        T = iT*0.005
        iT += 1
        props1, props2 = findCoexistence(T, eos1, eos2, Pguess, False)
        if not 'rho' in props1:
          InfoDialog("Trouble", f"Could not find coexistence for T={0}, Pguess={1}".format(T,Pguess))
          stopUpdate()
          return
        cors = {}
        if document['phase2'].value == "fcc":
          cor = correlator.propsForCoexCorrelation("vapor-fcc", T, props1, props2)
          cors["Schultz"] = {"props1": cor[0], "props2": cor[1]}
        window.addRow(T, props1, props2, cors)

        Pguess = props1['P']
        success = True
        if iT > 150:
          stopUpdate()

      def stopUpdate():
        global myInterval
        timer.clear_interval(myInterval)
        document["btnUpdate"].textContent = "Retrace coexistence"
        myInterval = None
        print("stopped")

      def update(ev):
        global eos1, eos2, myInterval, iT, Pguess, correlator, success
        if not myInterval == None:
          stopUpdate()
          return
        window.collapseParameters()
        document["btnUpdate"].textContent = "Stop"
        if correlator == None:
          correlator = CoexCorrelator(window.grabB3)
        phase1 = document['phase1'].value
        phase2 = document['phase2'].value
        if phase1 == phase2:
          InfoDialog("Trouble", f"The two phases must be different")
          return
        opts = optsForPhase(phase1, document, window.grabB3)
        if isinstance(opts,str):
          window.alert(opts)
          return
        eos1 = getEOS(phase1, opts)
        opts = optsForPhase(phase2, document, window.grabB3)
        if isinstance(opts,str):
          window.alert(opts)
          return
        eos2 = getEOS(phase2, opts)
        iT = 0
        Pguess = 0
        window.clearAllRows()
        success = True
        myInterval = timer.set_interval(doOneCoex, 0)

      document["btnUpdate"].bind("click", update)
    </script>
    <div class='container'>
      <h1 class='h2'><a href='index.html'><i class="fa-solid fa-house"></i></a> Vapor-Solid Phase Coexistence for LJ
      <button class='btn btn-xs btn-info' type='button' data-content='vapor-solid' data-bs-toggle="modal" data-bs-target="#infoModal">Info</button></h1>
    <div class="align-items-center" id="emscripten-status-div">
      <div style='margin-right: 1rem;' class='spinner-border ms-auto' role="status" aria-hidden="true"></div><span id='emscripten-status-text'>emscripten loading...</span>
    </div>
      <div id='parametersDiv' class='card mb-4'>
        <div id='headingParameters' class='card-header' role='tab'>
          <h2 class='h5 mb-0'>Phase Choices</a></h2>
      </div>
      <div class='show' aria-labelledby='headingParameters'>
        <div class='card-body'>
          <div class='row'>
            <div class='col-auto px-4'>
              <div class='row g-3 py-1 align-items-center'>
                <div class='col-auto'>
                  <label for='phase1' class='col-form-label'>Phase 1</label>
                </div>
                <div class='col-auto'>
                  <select class='form-select' id='phase1' onchange='phasesUpdated()'>
                    <option value='vapor' selected>Vapor</option>
                  </select>
                </div>
              </div>
              <div class='row g-3 py-1 align-items-center'>
                <div class='col-auto'>
                  <label for='phase2' class='col-form-label'>Phase 2</label>
                </div>
                <div class='col-auto'>
                  <select class='form-select' id='phase2' onchange='myPhasesUpdated()'>
                    <option value='fcc' selected>FCC</option>
                    <option value='hcp'>HCP</option>
                  </select>
                </div>
              </div>
            </div>
          </div>
          <div class='row g-3 py-1 align-items-center'>
            <div class='col-auto'>
              <button id='btnUpdate' class='btn btn-sm btn-primary' type='button'>Trace coexistence</button>
              <button class='btn btn-sm btn-info' type='button' data-content='coex-curve' data-bs-toggle="modal" data-bs-target="#infoModal">Info</button>
            </div>
          </div>
        </div>
      </div>
    </div>

      <div id='parametersDiv-vapor' class='card mb-4'>
        <div id='headingParameters-vapor' class='card-header' role='tab'>
          <h2 class='h5 mb-0'><a role='button' data-bs-toggle='collapse' href='#collapseparametersDiv-vapor' aria-expanded='true' aria-controls='colapseparametersDiv-vapor'>Vapor Parameters</a>
            <button class='btn btn-xs btn-info' type='button' data-content='vapor-param' data-bs-toggle="modal" data-bs-target="#infoModal">Info</button></h2>
        </div>
        <div id='collapseparametersDiv-vapor' class='collapse show' role='tabpanel' aria-labelledby='headingParameters-vapor'>
          <div class='card-body'>
            <div class='row'>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputEOS-vapor' class='col-form-label'>EOS</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputEOS-vapor' onchange='phaseChoiceUpdated("vapor")'>
                      <option value='Schultz' selected>Schultz (VEOS)</option>
                      <option value='Gottschalk'>Gottschalk</option>
                      <option value='Johnson'>Johnson</option>
                      <option value='Kolafa'>Kolafa</option>
                      <option value='May'>May</option>
                      <option value='Mecke'>Mecke</option>
                      <option value='Nicolas'>Nicolas</option>
                      <option value='Thol'>Thol</option>
                    </select>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputVEOSN-vapor' class='col-form-label'>VEOS order</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputVEOSN-vapor'>
                      <option value='9'>VEOS9</option>
                      <option value='8'>VEOS8</option>
                      <option value='7'>VEOS7</option>
                      <option value='6'>VEOS6</option>
                      <option value='5'>VEOS5</option>
                      <option value='4'>VEOS4</option>
                      <option value='3'>VEOS3</option>
                      <option value='2'>VEOS2</option>
                      <option value='1'>ideal gas</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='citation' id='vapor-ref-Schultz'>EOS Citations: Virial coefficients taken from A. J. Schultz and D. A. Kofke, "<a href='https://doi.org/10.1080/00268970903267053'>Sixth, seventh and eighth virial coefficients of the Lennard-Jones model</a>", <span class='pubName'>Mol. Phys.</span>, <span class='volume'>107</span>, 2309 (2009); N. S. Barlow, A. J. Schultz, D. A. Kofke, S. J. Weinstein, "<a href='https://doi.org/0.1002/aic.14531'>Critical Isotherms from Virial Series Using Asymptotically Consistent Approximants</a>", <span class='pubName'>AIChE J.</span> <span class='volume'>60</span>, 3336-3349 (2014); C. Feng, A. J. Schultz, V. Chaudhary, D. A. Kofke, "<a href='https://doi.org/10.1063/1.4927339'>Eighth to sixteenth virial coefficients of the Lennard-Jones model</a>", <span class='pubName'>J. Chem. Phys.</span> <span class='volume'>143</span>, 044504 (2015); includes additional coefficients computed more recently; fits for B<sub>4</sub>-B<sub>9</sub> as described in N. Gokul, A. J. Schultz, D. A. Kofke, "<a href='https://doi.org/10.1002/aic.17072'>Properties of supercritical N2, O2, CO2, and NH3 mixtures from the virial equation of state</a>", <span class='pubName'>AIChE J.</span> <span class='volume'>67</span>, e17072 (2021).</div>
                  <div class='citation' id='vapor-ref-Gottschalk'>EOS Citation: M. Gottschalk, "<a href='https://doi.org/10.1063/1.5119761'>An EOS for the Lennard-Jones fluid: A virial expansion approach</a>", <span class='pubName'>AIP Adv.</span> <span class='volume'>9</span>, 125206 (2019).</div>
                  <div class='citation' id='vapor-ref-Johnson'>EOS Citation: J. Johnson, J. Zollweg, and K. Gubbins, "<a href='https://doi.org/10.1080/00268979300100411'>The Lennard-Jones equation of state revisited</a>", <span class='pubName'>Mol. Phys.</span> <span class='volume'>78</span>, 591–618 (1993).</div>
                  <div class='citation' id='vapor-ref-Kolafa'>EOS Citation: J. Kolafa and I. Nezbeda, "<a href='https://doi.org/10.1016/0378-3812(94)80001-4'>The Lennard-Jones fluid: An accurate analytic and theoretically-based equation of state</a>", <span class='pubName'>Fluid Phase Equilib.</span> <span class='volume'>100</span>, 1 (1994).</div>
                  <div class='citation' id='vapor-ref-May'>EOS Citation: H.-O. May and P. Mausbach, "<a href='https://doi.org/10.1103/PhysRevE.85.031201'>Riemannian geometry study of vapor-liquid phase equilibria and supercritical behavior of the Lennard-Jones fluid</a>", <span class='pubName'>Phys. Rev. E</span> <span class='volume'>86</span>, 059905 (2012).</div>
                  <div class='citation' id='vapor-ref-Mecke'>EOS Citation: M. Mecke, A. Müller, J. Winkelmann, J. Vrabec, J. Fischer, R. Span and W. Wagner, "<a href='https://doi.org/10.1007/BF01443399'>An accurate Van der Waals-type equation of state for the Lennard-Jones fluid</a>", <span class='pubName'>Int. J. Thermophys.</span> <span class='volume'>17</span>, 391 (1996).</div>
                  <div class='citation' id='vapor-ref-Nicolas'>EOS Citation: J. J. Nicolas, K. E. Gubbins, W. B. Street, D. J. Tildesley, "<a href='https://doi.org/10.1080/00268977900101051'>Equation of state for the Lennard-Jones fluid</a>", <span class='pubName'>Mol. Phys.</span> <span class='volume'>37</span>, 1429 (1979).</div>
                  <div class='citation' id='vapor-ref-Thol'>EOS Citation: M. Thol, G. Rutkai, A. K ̈oster, R. Lustig, R. Span, and J. Vrabec, "<a href='https://doi.org/10.1063/1.4945000'>Equation of state for the Lennard-Jones fluid</a>", <span class='pubName'>J. Phys. Chem. Ref. Data</span> <span class='volume'>45</span>, 023101 (2016).</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='parametersDiv-hcp' class='card mb-4'>
        <div id='headingParameters-hcp' class='card-header' role='tab'>
          <h2 class='h5 mb-0'><a role='button' data-bs-toggle='collapse' href='#collapseparametersDiv-hcp' aria-expanded='true' aria-controls='colapseparametersDiv-hcp'>HCP Parameters</a>
            <button class='btn btn-xs btn-info' type='button' data-content='HCP-param' data-bs-toggle="modal" data-bs-target="#infoModal">Info</button></h2>
        </div>
        <div id='collapseparametersDiv-hcp' class='collapse show' role='tabpanel' aria-labelledby='headingParameters-hcp'>
          <div class='card-body'>
            <div class='row'>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputEOS-hcp' class='col-form-label'>EOS</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputEOS-hcp' onchange='phaseChoiceUpdated("hcp")'>
                      <option value='Schultz' selected>Schultz</option>
                      <option value='Adidharma'>Adidharma</option>
                    </select>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check' data-bs-toggle="tooltip" data-bs-placement="top" title="Choose which contributions to the free energy are included.">
                    EOS contributions beyond lattice
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkHarmonic-hcp' onchange='updateHarmContrib("hcp","harm")' checked>
                    <label class='form-check-label' for='checkHarmonic-hcp'>harmonic</label>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkAnharmonic-hcp' onchange='updateHarmContrib("hcp","anh")' checked>
                    <label class='form-check-label' for='checkAnharmonic-hcp'>anharmonic</label>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkAlpha-hcp' checked>
                    <label class='form-check-label' for='checkAlpha-hcp' data-bs-html='true' data-bs-toggle="tooltip" data-bs-placement="right" title="allow c/a to deviate from (8/3)<sup>1/2</sup>; alpha = (c/a)(8/3)<sup>-1/2</sup>">allow &alpha;&ne;1</label>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputN-hcp' class='col-form-label' data-bs-toggle="tooltip" data-bs-placement="top" title="# of atoms used for molecular simulations and lattice dynamics"># of atoms</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputN-hcp'>
                      <option value='0' selected>&infin;</option>
                      <option value='4096'>4096</option>
                      <option value='1728'>1728</option>
                      <option value='1200'>1200</option>
                      <option value='1000'>1000</option>
                      <option value='512'>512</option>
                    </select>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='rc-hcp' class='col-form-label' data-bs-toggle="tooltip" data-bs-placement="top" data-bs-html="true" title="use EOS for the given scaled potential truncation (r<sub>c</sub> &rho;<sup>-1/3</sup>); can be corrected by long-range correction (LRC)">cutoff</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputRc-hcp'>
                      <option value='-1' selected>&infin;</option>
                      <option value='11'>11</option>
                      <option value='9'>9</option>
                      <option value='7.5'>7.5</option>
                      <option value='6'>6</option>
                      <option value='5'>5</option>
                      <option value='4'>4</option>
                      <option value='3.5'>3.5</option>
                      <option value='3'>3</option>
                    </select>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkNrcc-hcp'>
                    <label class='form-check-label' for='checkNrcc-hcp' data-bs-toggle="tooltip" data-bs-placement="right" title="Lattice and harmonic contributions will be taken from untruncated estimates">apply only to anharmonic</label>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkLRC-hcp'>
                    <label class='form-check-label' for='checkLRC-hcp' data-bs-toggle="tooltip" data-bs-placement="right" title="Include standard long-range correction.  This should not be used in conjunction with 'apply only to anharmonic' as the standard LRC primarily corrects the lattice energy">include LRC</label>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='citation' id='hcp-ref-Schultz'>EOS Citation: A. J. Schultz, D. A. Kofke, "<a href='https://doi.org/10.1063/1.5053714'>Comprehensive high-precision high-accuracy equation of state and coexistence properties for classical Lennard-Jones crystals and low-temperature fluid phases</a>", <span class='pubName'>J. Chem. Phys.</span> <span class='volume'>149</span>, 204508 (2018).</div>
                  <div class='citation' id='hcp-ref-Adidharma'>EOS Citation: H. Adidharma and S. P. Tan, "<a href='https://doi.org/10.1063/1.4955061'>Accurate Monte Carlo simulations on FCC and HCP Lennard-Jones solids at very low temperatures and high reduced densities up to 1.30</a>", <span class='pubName'>J. Chem. Phys.</span> <span class='volume'>145</span>, 014503 (2016).</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='parametersDiv-fcc' class='card mb-4'>
        <div id='headingParameters-fcc' class='card-header' role='tab'>
          <h2 class='h5 mb-0'><a role='button' data-bs-toggle='collapse' href='#collapseparametersDiv-fcc' aria-expanded='true' aria-controls='colapseparametersDiv-fcc'>FCC Parameters</a>
            <button class='btn btn-xs btn-info' type='button' data-content='FCC-param' data-bs-toggle="modal" data-bs-target="#infoModal">Info</button></h2>
        </div>
        <div id='collapseparametersDiv-fcc' class='collapse show' role='tabpanel' aria-labelledby='headingParameters-fcc'>
          <div class='card-body'>
            <div class='row'>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputEOS-fcc' class='col-form-label'>EOS</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputEOS-fcc' onchange='phaseChoiceUpdated("fcc")'>
                      <option value='Schultz' selected>Schultz</option>
                      <option value='Adidharma'>Adidharma</option>
                      <option value='dePablo'>Mastny</option>
                      <option value='vdh'>van der Hoef</option>
                    </select>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check' data-bs-toggle="tooltip" data-bs-placement="top" title="Choose which contributions to the free energy are included.">
                    EOS contributions beyond lattice
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkHarmonic-fcc' onchange='updateHarmContrib("fcc","harm")' checked>
                    <label class='form-check-label' for='checkHarmonic-fcc'>harmonic</label>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkAnharmonic-fcc' onchange='updateHarmContrib("fcc","anh")' checked>
                    <label class='form-check-label' for='checkAnharmonic-fcc'>anharmonic</label>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkVac-fcc' onchange='updateVacancyCitation()'>
                    <label class='form-check-label' for='checkVac-fcc' data-bs-toggle="tooltip" data-bs-placement="right" title="include contribution to thermodynamic properties due to the existence of lattice vacancies">vacancy</label>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputN-fcc' class='col-form-label' data-bs-toggle="tooltip" data-bs-placement="top" title="# of atoms used for molecular simulations and lattice dynamics"># of atoms</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputN-fcc'>
                      <option value='0' selected>&infin;</option>
                      <option value='4000'>4000</option>
                      <option value='2048'>2048</option>
                      <option value='864'>864</option>
                      <option value='500'>500</option>
                      <option value='256'>256</option>
                    </select>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='rc-fcc' class='col-form-label' data-bs-toggle="tooltip" data-bs-placement="top" data-bs-html="true" title="use EOS for the given scaled potential truncation (r<sub>c</sub> &rho;<sup>-1/3</sup>); can be corrected by long-range correction (LRC)">cutoff</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputRc-fcc'>
                      <option value='-1' selected>&infin;</option>
                      <option value='11'>11</option>
                      <option value='9'>9</option>
                      <option value='7.5'>7.5</option>
                      <option value='6'>6</option>
                      <option value='5'>5</option>
                      <option value='4'>4</option>
                      <option value='3.5'>3.5</option>
                      <option value='3'>3</option>
                    </select>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkNrcc-fcc'>
                    <label class='form-check-label' for='checkNrcc-fcc' data-bs-toggle="tooltip" data-bs-placement="right" title="Lattice and harmonic contributions will be taken from untruncated estimates">apply only to anharmonic</label>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkLRC-fcc'>
                    <label class='form-check-label' for='checkLRC-fcc' data-bs-toggle="tooltip" data-bs-placement="right" title="Include standard long-range correction for potential truncation.  This should not be used in conjunction with 'apply only to anharmonic' as the standard LRC primarily corrects the lattice energy">include LRC</label>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='citation' id='fcc-ref-Schultz'>EOS Citations: A. J. Schultz, D. A. Kofke, "<a href='https://doi.org/10.1063/1.5053714'>Comprehensive high-precision high-accuracy equation of state and coexistence properties for classical Lennard-Jones crystals and low-temperature fluid phases</a>", <span class='pubName'>J. Chem. Phys.</span> <span class='volume'>149</span>, 204508 (2018)<span style='display: none;' id='vacancy-citation'>; A. Purohit, A. J. Schultz, S. G. Moustafa, J. R. Errington, D. A. Kofke, "<a href='https://doi.org/10.1080/00268976.2018.1481542'>Free energy and concentration of crystalline vacancies by molecular simulation</a>", Mol. Phys. 116, 3027-3041 (2018)</span>.</div>
                  <div class='citation' id='fcc-ref-Adidharma'>EOS Citation: H. Adidharma and S. P. Tan, "<a href='https://doi.org/10.1063/1.4955061'>Accurate Monte Carlo simulations on FCC and HCP Lennard-Jones solids at very low temperatures and high reduced densities up to 1.30</a>", <span class='pubName'>J. Chem. Phys.</span> <span class='volume'>145</span>, 014503 (2016).</div>
                  <div class='citation' id='fcc-ref-dePablo'>EOS Citation: E. A. Mastny and J. J. de Pablo, "<a href='https://doi.org/10.1063/1.2753149'>Melting line of the Lennard-Jones system, infinite size, and full potential</a>", <span class='pubName'>J. Chem. Phys.</span> <span class='volume'>127</span>, 104504 (2007).</div>
                  <div class='citation' id='fcc-ref-vdh'>EOS Citation: M. A. van der Hoef, "<a href='https://doi.org/10.1063/1.1314342'>Free energy of the Lennard-Jones solid</a>", <span class='pubName'>J. Chem.  Phys.</span> <span class='volume'>113</span>, 8142 (2000).</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

    <div id='resultsDiv' class='card'>
      <div id='headingResults' class='card-header' role='tab'>
        <h2 class='h5 mb-0' style='float: left'>Results</h2>
        <button id='copyBtn' class='btn btn-info btn-sm float-end' onclick='copyActiveTable()'>Copy</button>
        <button class='btn btn-info btn-sm float-end' style='margin-right: 1rem;' id='plotBtn' data-bs-toggle="modal" data-bs-target="#plotModal">Plot</button>
          <div class='float-end form-check' style='margin-right: 1rem;' id='subtractCorCheckboxDiv'>
            <input class='form-check-input' type='checkbox' value='' id='tabulateCorDiff' onchange='reconstructTable()'>
            <label class='form-check-label' for='tabulateCorDiff' data-bs-toggle="tooltip" data-bs-placement="right" title="Replaces data in table (except for T) with differences from correlation (based on Schultz predictions) for coexistence properties">subtract correlation</label>
          </div>
        </div>
        <div class='show' aria-labelledby='headingResults'>
          <div class='card-body'>
            <table class='table table-sm' id='coexResults'>
              <thead><tr><th id='T_col'>T</th><th id='rho1_col'>&rho;1</th><th id='rho2_col'>&rho;2</th><th id='P_col'>P</th><th id='G_col'>G</th><th id='phi_col'>&phi;</th></tr></thead>
              <tbody id='coex-table'></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <script src='emscripten.js'></script>
    <script async type="text/javascript" src="virial.js"></script>

    <div class="modal fade" id="plotModal" tabindex="-1" aria-labelledby="plotModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="plotModalLabel">Plot</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div id="plotDiv"></div>
            <div class='row'>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputXprop' class='col-form-label'>X:</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputXprop' onchange='myUpdatePlot()'>
                      <option value='T'>T</option>
                      <option value='rho' selected>&rho;</option>
                      <option value='P'>P</option>
                      <option value='U'>U</option>
                      <option value='A'>A</option>
                      <option value='G'>G</option>
                      <option value='Z'>Z</option>
                      <option value='Cv'>Cv</option>
                      <option value='phi'>&phi;</option>
                      <option value='alpha'>&alpha;</option>
                      <option value='v2'>v2</option>
                      <option value='Y'>Y</option>
                      <option value='H'>H</option>
                      <option value='S'>S</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputYprop' class='col-form-label'>Y:</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputYprop' onchange='myUpdatePlot()'>
                      <option value='T'>T</option>
                      <option value='rho'>&rho;</option>
                      <option value='P' selected>P</option>
                      <option value='U'>U</option>
                      <option value='A'>A</option>
                      <option value='G'>G</option>
                      <option value='Z'>Z</option>
                      <option value='Cv'>Cv</option>
                      <option value='phi'>&phi;</option>
                      <option value='alpha'>&alpha;</option>
                      <option value='v2'>v2</option>
                      <option value='Y'>Y</option>
                      <option value='H'>H</option>
                      <option value='S'>S</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='plotXDiff' onchange='myUpdatePlot()'>
                    <label class='form-check-label' for='plotXDiff' data-bs-toggle="tooltip" data-bs-placement="right" title="Plot a single set as the value for phase2 - phase1 instead of separate sets">X diff</label>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='plotYDiff' onchange='myUpdatePlot()'>
                    <label class='form-check-label' for='plotYDiff' data-bs-toggle="tooltip" data-bs-placement="right" title="Plot a single set as the value for phase2 - phase1 instead of separate sets">Y diff</label>
                  </div>
                </div>
              </div>
            </div>
            <div class='row'>
              <div class='col-auto px-4' style='display: none;' id='SLE-Tmax-div'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputTMax' class='col-form-label'>T<sub>max</sub></label>
                  </div>
                  <div class='col-auto'>
                    <input type='text' id='inputTMax' class='form-control' value='2' style='width: 4rem;' onchange='myUpdatePlot()'>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4' style='display: none;' id='SLE-rhomax-div'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputRhoMax' class='col-form-label'>&rho;<sub>max</sub></label>
                  </div>
                  <div class='col-auto'>
                    <input type='text' id='inputRhoMax' class='form-control' value='1.2' style='width: 4rem;' onchange='myUpdatePlot()'>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4' style='display: none;' id='tie-lines-div'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputNTieLines' class='col-form-label' data-bs-toggle="tooltip" data-bs-placement="bottom" title="tie lines will be drawn between coexisting points"># tie lines</label>
                  </div>
                  <div class='col-auto'>
                    <input type='text' id='inputNTieLines' class='form-control' value='0' style='width: 3rem;' onchange='myUpdatePlot()'>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4' style='display: none;' id='plot-cor-div'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='plotCor' onchange='myUpdatePlot()'>
                    <label class='form-check-label' for='plotCor' data-bs-toggle="tooltip" data-bs-placement="right" title="Plot correlation for coexistence properties">correlation</label>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="infoModal" tabindex="-1" aria-labelledby="infoModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-xl">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="infoModalLabel">Info</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <p>All info: <select class='form-select' style='width: auto; display: inline-block' id='info-modal-select'></select>
            <div id='infoModalBody'></div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>

  </body>
</html>
