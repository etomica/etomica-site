<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset='utf-8'>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>LJ EOS</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <link href='main.css' rel='stylesheet'>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/brython@3.10.3/brython.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/brython@3.10.3/brython_stdlib.js"></script>
    <script type='text/javascript' src='util.js'></script>
    <script src="https://cdn.plot.ly/plotly-2.11.1.min.js"></script>
    <script src="https://kit.fontawesome.com/7f972bf8c7.js" crossorigin="anonymous"></script>
  </head>
    <script>
document.title = "Triple Point for LJ";
window.addEventListener("load", phasesUpdated);
      window.addEventListener("load", updateLiquidRc);
    </script>
  </head>
  <body onload='brython()'>
    <script type='text/python' src='LJ_EOS.py'></script>
    <script type='text/python' src='EOS_util.py'></script>
    <script type='text/python'>
      from browser import document, window, timer
      from browser.widgets.dialog import InfoDialog
      from LJ_EOS import getEOS, findCoexistence
      from EOS_util import optsForPhase

      myInterval = None
      eos1 = eos2 = eos3 = None
      T = Tstep = Tmin = Tmax = lastDT = stage = 0
      props1a = props2a = props2b = props3b = None

      def pushData():
        global T, props1a, props2a, props2b, props3b
        document['Ta'].textContent = T
        document['Tb'].textContent = T
        document['rho1a'].textContent = props1a['rho']
        document['rho2a'].textContent = props2a['rho']
        document['rho2b'].textContent = props2b['rho']
        document['rho2gap'].textContent = props2b['rho'] - props2a['rho']
        document['rho3b'].textContent = props3b['rho']
        document['Pa'].textContent = props1a['P']
        document['Ga'].textContent = props1a['G']
        document['Pb'].textContent = props2b['P']
        document['Pgap'].textContent = props2b['P'] - props2a['P']
        document['Gb'].textContent = props2b['G']
        document['Ggap'].textContent = props2b['G'] - props2a['G']

      def doOneTriplePoint():
        global stage, eos1, eos2, eos3, props1a, props2a, props2b, props3b, lastDT, Tstep, Tmin, Tmax, T
        if stage == 1:
          props1a, props2a = findCoexistence(T, eos1, eos2, props1a['P'], False)
          stage = 2
          # we'll come back and do 2-3 and then analyze
          return
        props2b, props3b = findCoexistence(T, eos2, eos3, props1a['P'], False)
        stage = 1

        if 'rho' in props2a and 'rho' in props2b:
          pushData()
          # coex success for both, see how to adjust
          if props2b['rho'] > props2a['rho']:
            Tmax=T
            if T-Tmin < Tstep*2:
              Tstep = 0.5*(T-Tmin)
            if T-Tstep == T:
              stopUpdate()
              return
            T -= Tstep
            lastDT = -Tstep
          else:
            Tmin=T
            if Tmax-T < Tstep*2:
              Tstep = 0.5*(Tmax-T)
            if T+Tstep == T:
              stopUpdate()
              return
            T += Tstep
            lastDT=Tstep
        else:
          # at least one coex failed.  back off T and take smaller steps
          if lastDT == 0:
            # we didn't even start stepping yet.  probably bad guess
            InfoDialog("Trouble", f"Could not find triple point")
            return
     
          T -= lastDT
          Tstep *= 0.1
          lastDT *= 0.1
          T += lastDT

      def stopUpdate():
        global myInterval
        timer.clear_interval(myInterval)
        document["btnUpdate"].textContent = "Update"
        myInterval = None
        print("stopped")

      def update(ev):
        global myInterval, stage, eos1, eos2, eos3, props1a, props2a, props2b, props3b, lastDT, Tstep, Tmin, Tmax, T
        if not myInterval == None:
          stopUpdate()
          return
        window.collapseParameters()
        document["btnUpdate"].textContent = "Stop"

        phase1 = document['phase1'].value
        opts = optsForPhase(phase1, document, window.grabB3)
        if opts is None:
          return
        eos1 = getEOS(phase1, opts)
        phase2 = document['phase2'].value
        if phase1 == phase2:
          InfoDialog("Trouble", f"The three phases must be different")
          return
        opts = optsForPhase(phase2, document, window.grabB3)
        if opts is None:
          return
        eos2 = getEOS(phase2, opts)
        phase3 = document['phase3'].value
        if phase1 == phase3 or phase2 == phase3:
          InfoDialog("Trouble", f"The three phases must be different")
          return
        opts = optsForPhase(phase3, document, window.grabB3)
        if opts is None:
          return
        eos3 = getEOS(phase3, opts)
        Tguess = document['inputT'].value
        Tguess = float(Tguess)
        T=Tguess
        props1a = {'P': 0}
        Tmin=0
        Tmax=10
        Tstep=0.001;
        lastDT=0
        stage = 1
        myInterval = timer.set_interval(doOneTriplePoint, 0)

      document["btnUpdate"].bind("click", update)
    </script>
    <div class='container'>
    <figure style="overflow:visible;" id="spinner"><div class="spinner"></div><center style="margin-top:0.5em"><strong>emscripten</strong></center></figure>
    <div class="emscripten" id="status">Downloading...</div>
    <div class="emscripten">
      <progress value="0" max="100" id="progress" hidden=1></progress>  
    </div>
      <h1 class='h2'><a href='index.html'><i class="fa-solid fa-house"></i></a> Triple Point for LJ</h1>
      <div id='parametersDiv' class='card mb-4'>
        <div id='headingParameters' class='card-header' role='tab'>
          <h2 class='h5 mb-0'>Phase Choices</a></h2>
      </div>
      <div class='show' aria-labelledby='headingParameters'>
        <div class='card-body'>
          <div class='row'>
            <div class='col-auto px-4'>
              <div class='row g-3 py-1 align-items-center'>
                <div class='col-auto'>
                  <label for='inputT' class='col-form-label'>T</label>
                </div>
                <div class='col-auto'>
                  <input type='text' id='inputT' class='form-control' placeholder='estimate'>
                </div>
              </div>
              <div class='row g-3 py-1 align-items-center' style='margin-top: 1rem;'>
                Phases must be listed in order of increasing density
              </div>
              <div class='row g-3 py-1 align-items-center'>
                <div class='col-auto'>
                  <label for='phase1' class='col-form-label'>Phase 1</label>
                </div>
                <div class='col-auto'>
                  <select class='form-select' id='phase1' onchange='phasesUpdated()'>
                    <option value='vapor' selected>Vapor</option>
                  </select>
                </div>
              </div>
              <div class='row g-3 py-1 align-items-center'>
                <div class='col-auto'>
                  <label for='phase2' class='col-form-label'>Phase 2</label>
                </div>
                <div class='col-auto'>
                  <select class='form-select' id='phase2' onchange='phasesUpdated()'>
                    <option value='liquid' selected>Liquid</option>
                    <option value='fcc'>FCC</option>
                  </select>
                </div>
              </div>
              <div class='row g-3 py-1 align-items-center'>
                <div class='col-auto'>
                  <label for='phase3' class='col-form-label'>Phase 3</label>
                </div>
                <div class='col-auto'>
                  <select class='form-select' id='phase3' onchange='phasesUpdated()'>
                    <option value='fcc' selected>FCC</option>
                    <option value='hcp'>HCP</option>
                  </select>
                </div>
              </div>
            </div>
          </div>
          <div class='row g-3 py-1 align-items-center'>
            <div class='col-auto'>
              <button id='btnUpdate' class='btn btn-sm btn-primary' type='button'>Update</button>
              <button class='btn btn-sm btn-info' type='button' data-bs-toggle="modal" data-bs-target="#infoTPModal">Info</button>
            </div>
          </div>
        </div>
      </div>
    </div>

      <div id='parametersDiv-vapor' class='card mb-4'>
        <div id='headingParameters-vapor' class='card-header' role='tab'>
          <h2 class='h5 mb-0'><a role='button' data-bs-toggle='collapse' href='#collapseparametersDiv-vapor' aria-expanded='true' aria-controls='colapseparametersDiv-vapor'>Vapor Parameters</a></h2>
        </div>
        <div id='collapseparametersDiv-vapor' class='collapse show' role='tabpanel' aria-labelledby='headingParameters-vapor'>
          <div class='card-body'>
            <div class='row'>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputEOS-vapor' class='col-form-label'>EOS</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputEOS-vapor' onchange='phaseChoiceUpdated("vapor")'>
                      <option value='Schultz' selected>Schultz (VEOS)</option>
                      <option value='Johnson'>Johnson</option>
                      <option value='Kolafa'>Kolafa</option>
                      <option value='May'>May</option>
                      <option value='Thol'>Thol</option>
                    </select>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputVEOSN' class='col-form-label'>VEOS order</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputVEOSN'>
                      <option value='9'>VEOS9</option>
                      <option value='8'>VEOS8</option>
                      <option value='7'>VEOS7</option>
                      <option value='6'>VEOS6</option>
                      <option value='5'>VEOS5</option>
                      <option value='4'>VEOS4</option>
                      <option value='3'>VEOS3</option>
                      <option value='2'>VEOS2</option>
                      <option value='1'>ideal gas</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='citation' id='vapor-ref-Schultz'>EOS Citations: Virial coefficients taken from A. J. Schultz and D. A. Kofke, "<a href='https://doi.org/10.1080/00268970903267053'>Sixth, seventh and eighth virial coefficients of the Lennard-Jones model</a>", <span class='pubName'>Mol. Phys.</span>, <span class='volume'>107</span>, 2309 (2009); N. S. Barlow, A. J. Schultz, D. A. Kofke, S. J. Weinstein, "<a href='https://doi.org/0.1002/aic.14531'>Critical Isotherms from Virial Series Using Asymptotically Consistent Approximants</a>", <span class='pubName'>AIChE J.</span> <span class='volume'>60</span>, 3336-3349 (2014); C. Feng, A. J. Schultz, V. Chaudhary, D. A. Kofke, "<a href='https://doi.org/10.1063/1.4927339'>Eighth to sixteenth virial coefficients of the Lennard-Jones model</a>", <span class='pubName'>J. Chem. Phys.</span> <span class='volume'>143</span>, 044504 (2015); includes additional coefficients computed more recently; fits for B<sub>4</sub>-B<sub>9</sub> as described in N. Gokul, A. J. Schultz, D. A. Kofke, "<a href='https://doi.org/10.1002/aic.17072'>Properties of supercritical N2, O2, CO2, and NH3 mixtures from the virial equation of state</a>", <span class='pubName'>AIChE J.</span> <span class='volume'>67</span>, e17072 (2021).</div>
                  <div class='citation' id='vapor-ref-Johnson'>EOS Citation: J. Johnson, J. Zollweg, and K. Gubbins, "<a href='https://doi.org/10.1080/00268979300100411'>The Lennard-Jones equation of state revisited</a>", <span class='pubName'>Mol. Phys.</span> <span class='volume'>78</span>, 591–618 (1993).</div>
                  <div class='citation' id='vapor-ref-Kolafa'>EOS Citation: J. Kolafa and I. Nezbeda, "<a href='https://doi.org/10.1016/0378-3812(94)80001-4'>The Lennard-Jones fluid: An accurate analytic and theoretically-based equation of state</a>", <span class='pubName'>Fluid Phase Equilib.</span> <span class='volume'>100</span>, 1 (1994).</div>
                  <div class='citation' id='vapor-ref-May'>EOS Citation: H.-O. May and P. Mausbach, "<a href='https://doi.org/10.1103/PhysRevE.85.031201'>Riemannian geometry study of vapor-liquid phase equilibria and supercritical behavior of the Lennard-Jones fluid</a>", <span class='pubName'>Phys. Rev. E</span> <span class='volume'>86</span>, 059905 (2012).</div>
                  <div class='citation' id='vapor-ref-Thol'>EOS Citation: M. Thol, G. Rutkai, A. K ̈oster, R. Lustig, R. Span, and J. Vrabec, "<a href='https://doi.org/10.1063/1.4945000'>Equation of state for the Lennard-Jones fluid</a>", <span class='pubName'>J. Phys. Chem. Ref. Data</span> <span class='volume'>45</span>, 023101 (2016).</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='parametersDiv-liquid' class='card mb-4'>
        <div id='headingParameters-liquid' class='card-header' role='tab'>
          <h2 class='h5 mb-0'><a role='button' data-bs-toggle='collapse' href='#collapseparametersDiv-liquid' aria-expanded='true' aria-controls='colapseparametersDiv-liquid'>Liquid Parameters</a></h2>
        </div>
        <div id='collapseparametersDiv-liquid' class='collapse show' role='tabpanel' aria-labelledby='headingParameters-liquid'>
          <div class='card-body'>
            <div class='row'>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputEOS-liquid' class='col-form-label'>EOS</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputEOS-liquid' onchange='phaseChoiceUpdated("liquid")'>
                      <option value='Schultz' selected>Schultz</option>
                      <option value='Johnson'>Johnson</option>
                      <option value='Kolafa'>Kolafa</option>
                      <option value='May'>May</option>
                      <option value='Thol'>Thol</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputNl' class='col-form-label' data-bs-toggle="tooltip" data-bs-placement="top" title="# of atoms used for molecular simulations"># of atoms</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputNl'>
                      <option value='0' selected>&infin;</option>
                      <option value='4000'>4000</option>
                      <option value='2000'>2000</option>
                      <option value='1000'>1000</option>
                      <option value='500'>500</option>
                      <option value='250'>250</option>
                    </select>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='rc-liquid' class='col-form-label' data-bs-toggle="tooltip" data-bs-placement="top" data-bs-html="true" title="use EOS for the given scaled potential truncation (r<sub>c</sub> &rho;<sup>-1/3</sup>); can be corrected by long-range correction (LRC)">cutoff</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputRc-liquid'>
                      <option value='-1' selected>&infin;</option>
                      <option value='9'>9</option>
                      <option value='8'>8</option>
                      <option value='7'>7</option>
                      <option value='6'>6</option>
                      <option value='5'>5</option>
                      <option value='4'>4</option>
                      <option value='3'>3</option>
                      <option value='2'>2</option>
                      <option value='1'>1</option>
                      <option value='0'>0</option>
                    </select>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkLRC-liquid'>
                    <label class='form-check-label' for='checkLRC-liquid' data-bs-toggle="tooltip" data-bs-placement="right" title="Include standard long-range correction for potential truncation">include LRC</label>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='citation' id='liquid-ref-Schultz'>EOS Citation: A. J. Schultz, D. A. Kofke, "<a href='https://doi.org/10.1063/1.5053714'>Comprehensive high-precision high-accuracy equation of state and coexistence properties for classical Lennard-Jones crystals and low-temperature fluid phases</a>", <span class='pubName'>J. Chem. Phys.</span> <span class='volume'>149</span>, 204508 (2018).</div>
                  <div class='citation' id='liquid-ref-Johnson'>EOS Citation: J. Johnson, J. Zollweg, and K. Gubbins, "<a href='https://doi.org/10.1080/00268979300100411'>The Lennard-Jones equation of state revisited</a>", <span class='pubName'>Mol. Phys.</span> <span class='volume'>78</span>, 591–618 (1993).</div>
                  <div class='citation' id='liquid-ref-Kolafa'>EOS Citation: J. Kolafa and I. Nezbeda, "<a href='https://doi.org/10.1016/0378-3812(94)80001-4'>The Lennard-Jones fluid: An accurate analytic and theoretically-based equation of state</a>", <span class='pubName'>Fluid Phase Equilib.</span> <span class='volume'>100</span>, 1 (1994).</div>
                  <div class='citation' id='liquid-ref-May'>EOS Citation: H.-O. May and P. Mausbach, "<a href='https://doi.org/10.1103/PhysRevE.85.031201'>Riemannian geometry study of vapor-liquid phase equilibria and supercritical behavior of the Lennard-Jones fluid</a>", <span class='pubName'>Phys. Rev. E</span> <span class='volume'>86</span>, 059905 (2012).</div>
                  <div class='citation' id='liquid-ref-Thol'>EOS Citation: M. Thol, G. Rutkai, A. K ̈oster, R. Lustig, R. Span, and J. Vrabec, "<a href='https://doi.org/10.1063/1.4945000'>Equation of state for the Lennard-Jones fluid</a>", <span class='pubName'>J. Phys. Chem. Ref. Data</span> <span class='volume'>45</span>, 023101 (2016).</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div id='parametersDiv-hcp' class='card mb-4'>
        <div id='headingParameters-hcp' class='card-header' role='tab'>
          <h2 class='h5 mb-0'><a role='button' data-bs-toggle='collapse' href='#collapseparametersDiv-hcp' aria-expanded='true' aria-controls='colapseparametersDiv-hcp'>HCP Parameters</a></h2>
        </div>
        <div id='collapseparametersDiv-hcp' class='collapse show' role='tabpanel' aria-labelledby='headingParameters-hcp'>
          <div class='card-body'>
            <div class='row'>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputEOS-hcp' class='col-form-label'>EOS</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputEOS-hcp' onchange='phaseChoiceUpdated("hcp")'>
                      <option value='Schultz' selected>Schultz</option>
                      <option value='Adidharma'>Adidharma</option>
                    </select>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkLat-hcp'>
                    <label class='form-check-label' for='checkLat-hcp'>lattice properties</label>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkHarmonic-hcp'>
                    <label class='form-check-label' for='checkHarmonic-hcp'>lattice+harmonic properties</label>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkAlpha'>
                    <label class='form-check-label' for='checkAlpha' data-bs-toggle="tooltip" data-bs-placement="right" title="enforce 'ideal' c/a=(8/3)^(1/2); alpha = (c/a)(8/3)^(-1/2)">impose &alpha;=1</label>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputNh' class='col-form-label' data-bs-toggle="tooltip" data-bs-placement="top" title="# of atoms used for molecular simulations and lattice dynamics"># of atoms</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputNh'>
                      <option value='0' selected>&infin;</option>
                      <option value='4096'>4096</option>
                      <option value='1728'>1728</option>
                      <option value='1200'>1200</option>
                      <option value='1000'>1000</option>
                      <option value='512'>512</option>
                    </select>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='rc-hcp' class='col-form-label' data-bs-toggle="tooltip" data-bs-placement="top" data-bs-html="true" title="use EOS for the given scaled potential truncation (r<sub>c</sub> &rho;<sup>-1/3</sup>); can be corrected by long-range correction (LRC)">cutoff</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputRc-hcp'>
                      <option value='0' selected>&infin;</option>
                      <option value='11'>11</option>
                      <option value='9'>9</option>
                      <option value='7.5'>7.5</option>
                      <option value='6'>6</option>
                      <option value='5'>5</option>
                      <option value='4'>4</option>
                      <option value='3.5'>3.5</option>
                      <option value='3'>3</option>
                    </select>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkNrcc-hcp'>
                    <label class='form-check-label' for='checkNrcc-hcp' data-bs-toggle="tooltip" data-bs-placement="right" title="Lattice and harmonic contributions will be taken from untruncated estimates">apply only to anharmonic</label>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkLRC-hcp'>
                    <label class='form-check-label' for='checkLRC-hcp' data-bs-toggle="tooltip" data-bs-placement="right" title="Include standard long-range correction.  This should not be used in conjunction with 'apply only to anharmonic' as the standard LRC primarily corrects the lattice energy">include LRC</label>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='citation' id='hcp-ref-Schultz'>EOS Citation: A. J. Schultz, D. A. Kofke, "<a href='https://doi.org/10.1063/1.5053714'>Comprehensive high-precision high-accuracy equation of state and coexistence properties for classical Lennard-Jones crystals and low-temperature fluid phases</a>", <span class='pubName'>J. Chem. Phys.</span> <span class='volume'>149</span>, 204508 (2018).</div>
                  <div class='citation' id='hcp-ref-Adidharma'>EOS Citation: H. Adidharma and S. P. Tan, "<a href='https://doi.org/10.1063/1.4955061'>Accurate Monte Carlo simulations on FCC and HCP Lennard-Jones solids at very low temperatures and high reduced densities up to 1.30</a>", <span class='pubName'>J. Chem. Phys.</span> <span class='volume'>145</span>, 014503 (2016).</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='parametersDiv-fcc' class='card mb-4'>
        <div id='headingParameters-fcc' class='card-header' role='tab'>
          <h2 class='h5 mb-0'><a role='button' data-bs-toggle='collapse' href='#collapseparametersDiv-fcc' aria-expanded='true' aria-controls='colapseparametersDiv-fcc'>FCC Parameters</a></h2>
        </div>
        <div id='collapseparametersDiv-fcc' class='collapse show' role='tabpanel' aria-labelledby='headingParameters-fcc'>
          <div class='card-body'>
            <div class='row'>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputEOS-fcc' class='col-form-label'>EOS</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputEOS-fcc' onchange='phaseChoiceUpdated("fcc")'>
                      <option value='Schultz' selected>Schultz</option>
                      <option value='Adidharma'>Adidharma</option>
                      <option value='dePablo'>de Pablo</option>
                      <option value='vdh'>van der Hoef</option>
                    </select>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkLat-fcc'>
                    <label class='form-check-label' for='checkLat-fcc'>lattice properties</label>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkHarmonic-fcc'>
                    <label class='form-check-label' for='checkHarmonic-fcc'>lattice+harmonic properties</label>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkVac-fcc'>
                    <label class='form-check-label' for='checkVac-fcc' data-bs-toggle="tooltip" data-bs-placement="right" title="include contribution to thermodynamic properties due to the existence of lattice vacancies">include vacancies</label>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputNf' class='col-form-label' data-bs-toggle="tooltip" data-bs-placement="top" title="# of atoms used for molecular simulations and lattice dynamics"># of atoms</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputNf'>
                      <option value='0' selected>&infin;</option>
                      <option value='4000'>4000</option>
                      <option value='2048'>2048</option>
                      <option value='864'>864</option>
                      <option value='500'>500</option>
                      <option value='256'>256</option>
                    </select>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='rc-fcc' class='col-form-label' data-bs-toggle="tooltip" data-bs-placement="top" data-bs-html="true" title="use EOS for the given scaled potential truncation (r<sub>c</sub> &rho;<sup>-1/3</sup>); can be corrected by long-range correction (LRC)">cutoff</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputRc-fcc'>
                      <option value='0' selected>&infin;</option>
                      <option value='11'>11</option>
                      <option value='9'>9</option>
                      <option value='7.5'>7.5</option>
                      <option value='6'>6</option>
                      <option value='5'>5</option>
                      <option value='4'>4</option>
                      <option value='3.5'>3.5</option>
                      <option value='3'>3</option>
                    </select>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkNrcc-fcc'>
                    <label class='form-check-label' for='checkNrcc-fcc' data-bs-toggle="tooltip" data-bs-placement="right" title="Lattice and harmonic contributions will be taken from untruncated estimates">apply only to anharmonic</label>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkLRC-fcc'>
                    <label class='form-check-label' for='checkLRC-fcc' data-bs-toggle="tooltip" data-bs-placement="right" title="Include standard long-range correction for potential truncation.  This should not be used in conjunction with 'apply only to anharmonic' as the standard LRC primarily corrects the lattice energy">include LRC</label>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='citation' id='fcc-ref-Schultz'>EOS Citation: A. J. Schultz, D. A. Kofke, "<a href='https://doi.org/10.1063/1.5053714'>Comprehensive high-precision high-accuracy equation of state and coexistence properties for classical Lennard-Jones crystals and low-temperature fluid phases</a>", <span class='pubName'>J. Chem. Phys.</span> <span class='volume'>149</span>, 204508 (2018).</div>
                  <div class='citation' id='fcc-ref-Adidharma'>EOS Citation: H. Adidharma and S. P. Tan, "<a href='https://doi.org/10.1063/1.4955061'>Accurate Monte Carlo simulations on FCC and HCP Lennard-Jones solids at very low temperatures and high reduced densities up to 1.30</a>", <span class='pubName'>J. Chem. Phys.</span> <span class='volume'>145</span>, 014503 (2016).</div>
                  <div class='citation' id='fcc-ref-dePablo'>EOS Citation: E. A. Mastny and J. J. de Pablo, "<a href='https://doi.org/10.1063/1.2753149'>Melting line of the Lennard-Jones system, infinite size, and full potential</a>", <span class='pubName'>J. Chem. Phys.</span> <span class='volume'>127</span>, 104504 (2007).</div>
                  <div class='citation' id='fcc-ref-vdh'>EOS Citation: M. A. van der Hoef, "<a href='https://doi.org/10.1063/1.1314342'>Free energy of the Lennard-Jones solid</a>", <span class='pubName'>J. Chem.  Phys.</span> <span class='volume'>113</span>, 8142 (2000).</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

    <div id='resultsDiv' class='card'>
      <div id='headingResults' class='card-header' role='tab'>
        <h2 class='h5 mb-0'>Results</a></h2>
    </div>
    <div class='show' aria-labelledby='headingResults'>
      <div class='card-body'>
        <table class='table'>
          <thead><tr><th>Prop</th><th>Phase1 - Phase2</th><th>Phase2 - Phase3</th><th>Gap</th></tr></thead>
          <tbody>
          <tr><td>T</td><td id='Ta'></td><td id='Tb'></td><td></td></tr>
          <tr><td>&rho;1</td><td id='rho1a'></td><td></td><td></td></tr>
          <tr><td>&rho;2</td><td id='rho2a'></td><td id='rho2b'></td><td id='rho2gap'></td></tr>
          <tr><td>&rho;3</td><td></td><td id='rho3b'></td><td></td></tr>
          <tr><td>P</td><td id='Pa'></td><td id='Pb'></td><td id='Pgap'></td></tr>
          <tr><td>G</td><td id='Ga'></td><td id='Gb'></td><td id='Ggap'></td></tr>
          </tbody>
        </table>
      </div>
        </div>
      </div>
    </div>
    <script src='emscripten.js'></script>
    <script async type="text/javascript" src="virial.js"></script>

    <div class="modal fade" id="infoTPModal" tabindex="-1" aria-labelledby="infoTPModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="infoTPModalLabel">EOS Triple Point Info</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <p>The EOS triple point page allows you to determine the triple point for any three phases.  An estimate of the triple point temperature is necessary, but even a poor estimate may be sufficient.</p>
            <p>You may choose between vapor, liquid, FCC and HCP for the three phases.  For each choice of phase, you may also choose the EOS and any EOS parameters to describe its behavior.  Choosing inappropriate parameters may result in failure to find triple point; a solid described with lattice dynamics is likely to have no equilibrium with the liquid.  Likewise, a model with short truncation (and no LRC) may not have a triple point within range of validity of the EOS.</p>
            <p>Finding the triple point requires finding coexistence at a estimate of the triple point temperature and then improving that estimate via bisection.  The coexistence properties at these temperatures are reported in the results table with one column for the results of coexistence between the phase1 and phase2 and another column for the coexistence between phase2 and phase3.  The gaps in properties that should be the same (P, G and the density of the intermediate phase2) are reported in the last column to give you an idea of progress.</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>

  </body>
</html>
