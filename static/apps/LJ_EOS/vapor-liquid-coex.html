<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset='utf-8'>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>LJ EOS</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <link href='main.css' rel='stylesheet'>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/brython@3.10.3/brython.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/brython@3.10.3/brython_stdlib.js"></script>
    <script type='text/javascript' src='util.js'></script>
    <script src="https://cdn.plot.ly/plotly-2.11.1.min.js"></script>
    <script src="https://kit.fontawesome.com/7f972bf8c7.js" crossorigin="anonymous"></script>
  </head>
    <script>
document.title = "Vapor-Liquid Phase Coexistence for LJ";
      function myUpdatePlot() {
        var xsets = document.getElementById("plotXDiff").checked ? "diff" : "auto";
        var ysets = document.getElementById("plotYDiff").checked ? "diff" : "auto";
        updatePlotCoex("vapor", "liquid", Infinity, Infinity, xsets, ysets);
      }
      window.addEventListener("load", function() {
        document.getElementById("tie-lines-div").style.display = "block";
        var plotModalEl = document.getElementById("plotModal");
        plotModalEl.addEventListener("show.bs.modal", myUpdatePlot);
      });
      window.addEventListener("load", updateLiquidRc);
function clearAllRows() {
  var tbody = document.getElementById("coex-table");
  empty(tbody);
}
  
var copyText0 = "T,rho1,rho2,P,G\n";
var copyText = copyText0;
var allData = [];
function addRow(T, props1, props2) {
  var tbody = document.getElementById("coex-table");
  var row = makeElement("TR", tbody);
  allData.push({T: T, props1: props1, props2: props2});
  var v = [T, props1['rho'], props2['rho'], props1['P'], props1['G']];
  for (var i=0; i<v.length; i++) {
    makeElement("TD", row, {textContent: v[i]});
  }
  copyText += v.join(",")+"\n";
}

function collapse1Parameter(id) {
  var foo = document.getElementById("collapse"+id);
  new bootstrap.Collapse(foo, {toggle: false}).hide();
}
function collapseParameters() {
  collapse1Parameter("parametersDiv-vapor");
  collapse1Parameter("parametersDiv-liquid");
}
window.addEventListener("load", phasesUpdated);
    </script>
  </head>
  <body onload='brython()'>
    <script type='text/python' src='LJ_EOS.py'></script>
    <script type='text/python' src='EOS_util.py'></script>
    <script type='text/python'>
      from browser import document, window, timer
      from browser.widgets.dialog import InfoDialog
      from LJ_EOS import getEOS, findCoexistence
      from EOS_util import optsForPhase

      eos1 = eos2 = None
      myInterval = None
      Pguess = 0
      success = True

      def doOneCoex():
        global eos1, eos2, myInterval, iT, Pguess, success
        if not success:
          stopUpdate()
          return
        success = False
        try:
          Tstep = float(document["inputTstep"].value)
        except ValueError:
          InfoDialog("Trouble", f"Must provide a valid Tstep")
          return
        T = iT*Tstep
        try:
          Tmax = float(document["inputTmax"].value)
        except ValueError:
          InfoDialog("Trouble", f"Must provide a valid Tmax")
          return
        if T > Tmax+0.000000001:
          stopUpdate()
          return
        props1, props2 = findCoexistence(T, eos1, eos2, Pguess, False)
        if not 'rho' in props1:
          InfoDialog("Trouble", f"Could not find coexistence for T="+str(T)+", Pguess="+str(Pguess))
          stopUpdate()
          return
        window.addRow(T, props1, props2);

        Pguess = props1['P']
        iT += 1
        success = True

      def stopUpdate():
        global myInterval
        timer.clear_interval(myInterval)
        document["btnUpdate"].textContent = "Update"
        myInterval = None
        print("stopped")

      def update(ev):
        global eos1, eos2, myInterval, iT, Pguess, success
        if not myInterval == None:
          stopUpdate()
          return
        success = True
        window.collapseParameters()
        document["btnUpdate"].textContent = "Stop"
        phase1 = document['phase1'].value
        opts = optsForPhase(phase1, document, window.grabB3)
        if opts is None:
          return
        eos1 = getEOS(phase1, opts)
        phase2 = document['phase2'].value
        if phase1 == phase2:
          InfoDialog("Trouble", f"The two phases must be different")
          return
        opts = optsForPhase(phase2, document, window.grabB3)
        if opts is None:
          return
        eos2 = getEOS(phase2, opts)
        try:
          Tstep = float(document["inputTstep"].value)
        except ValueError:
          InfoDialog("Trouble", f"Must provide a valid Tstep")
          return
        try:
          Tmin = float(document["inputTmin"].value)
        except ValueError:
          InfoDialog("Trouble", f"Must provide a valid Tmin")
          return
        iT = int(Tmin / Tstep)
        Pguess = 0
        window.clearAllRows()
        window.copyText = window.copyText0
        myInterval = timer.set_interval(doOneCoex, 0)

      document["btnUpdate"].bind("click", update)
    </script>
    <div class='container'>
    <figure style="overflow:visible;" id="spinner"><div class="spinner"></div><center style="margin-top:0.5em"><strong>emscripten</strong></center></figure>
    <div class="emscripten" id="status">Downloading...</div>
    <div class="emscripten">
      <progress value="0" max="100" id="progress" hidden=1></progress>  
    </div>
      <h1><a href='index.html'><i class="fa-solid fa-house"></i></a> Vapor-Liquid Phase Coexistence for LJ
      <button class='btn btn-xs btn-info' type='button' data-bs-toggle="modal" data-bs-target="#infoVaporLiquidCoexModal">Info</button></h1>
      <div id='parametersDiv' class='card mb-4'>
        <div id='headingParameters' class='card-header' role='tab'>
          <h2 class='h5 mb-0'>Phase Choices</a></h2>
      </div>
      <div class='show' aria-labelledby='headingParameters'>
        <div class='card-body'>
          <div class='row'>
            <div class='col-auto px-4'>
              <div class='row g-3 py-1 align-items-center'>
                <div class='col-auto'>
                  <label for='phase1' class='col-form-label'>Phase 1</label>
                </div>
                <div class='col-auto'>
                  <select class='form-select' id='phase1' onchange='phasesUpdated()'>
                    <option value='vapor' selected>Vapor</option>
                  </select>
                </div>
              </div>
              <div class='row g-3 py-1 align-items-center'>
                <div class='col-auto'>
                  <label for='phase2' class='col-form-label'>Phase 2</label>
                </div>
                <div class='col-auto'>
                  <select class='form-select' id='phase2' onchange='phasesUpdated()'>
                    <option value='liquid' selected>Liquid</option>
                  </select>
                </div>
              </div>
              <div class='row g-3 py-1 align-items-center'>
                <div class='col-auto'>
                  <label for='inputTmin' class='col-form-label'>T<sub>min</sub></label>
                </div>
                <div class='col-auto'>
                  <input type='text' class='form-control' id='inputTmin' style='width: 5rem;' value='0.67'>
                </div>
                <div class='col-auto'>
                  <label for='inputTstep' class='col-form-label'>T<sub>step</sub></label>
                </div>
                <div class='col-auto'>
                  <input type='text' class='form-control' id='inputTstep' style='width: 5rem;' value='0.001'>
                </div>
                <div class='col-auto'>
                  <label for='inputTmax' class='col-form-label'>T<sub>max</sub></label>
                </div>
                <div class='col-auto'>
                  <input type='text' class='form-control' id='inputTmax' style='width: 5rem;' value='0.9'>
                </div>
              </div>
            </div>
          </div>
          <div class='row g-3 py-1 align-items-center'>
            <div class='col-auto'>
              <button id='btnUpdate' class='btn btn-sm btn-primary' type='button'>Trace coexistence</button>
              <button class='btn btn-sm btn-info' type='button' data-bs-toggle="modal" data-bs-target="#infoCoexCurveModal">Info</button>
            </div>
          </div>
        </div>
      </div>
    </div>

      <div id='parametersDiv-vapor' class='card mb-4'>
        <div id='headingParameters-vapor' class='card-header' role='tab'>
          <h2 class='h5 mb-0'><a role='button' data-bs-toggle='collapse' href='#collapseparametersDiv-vapor' aria-expanded='true' aria-controls='colapseparametersDiv-vapor'>Vapor Parameters</a></h2>
        </div>
        <div id='collapseparametersDiv-vapor' class='collapse show' role='tabpanel' aria-labelledby='headingParameters-vapor'>
          <div class='card-body'>
            <div class='row'>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputEOS-vapor' class='col-form-label'>EOS</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputEOS-vapor' onchange='phaseChoiceUpdated("vapor")'>
                      <option value='Schultz' selected>Schultz (VEOS)</option>
                      <option value='Johnson'>Johnson</option>
                      <option value='Kolafa'>Kolafa</option>
                      <option value='May'>May</option>
                      <option value='Thol'>Thol</option>
                    </select>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputVEOSN' class='col-form-label'>VEOS order</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputVEOSN'>
                      <option value='9'>VEOS9</option>
                      <option value='8'>VEOS8</option>
                      <option value='7'>VEOS7</option>
                      <option value='6'>VEOS6</option>
                      <option value='5'>VEOS5</option>
                      <option value='4'>VEOS4</option>
                      <option value='3'>VEOS3</option>
                      <option value='2'>VEOS2</option>
                      <option value='1'>ideal gas</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='citation' id='vapor-ref-Schultz'>EOS Citations: Virial coefficients taken from A. J. Schultz and D. A. Kofke, "<a href='https://doi.org/10.1080/00268970903267053'>Sixth, seventh and eighth virial coefficients of the Lennard-Jones model</a>", <span class='pubName'>Mol. Phys.</span>, <span class='volume'>107</span>, 2309 (2009); N. S. Barlow, A. J. Schultz, D. A. Kofke, S. J. Weinstein, "<a href='https://doi.org/0.1002/aic.14531'>Critical Isotherms from Virial Series Using Asymptotically Consistent Approximants</a>", <span class='pubName'>AIChE J.</span> <span class='volume'>60</span>, 3336-3349 (2014); C. Feng, A. J. Schultz, V. Chaudhary, D. A. Kofke, "<a href='https://doi.org/10.1063/1.4927339'>Eighth to sixteenth virial coefficients of the Lennard-Jones model</a>", <span class='pubName'>J. Chem. Phys.</span> <span class='volume'>143</span>, 044504 (2015); includes additional coefficients computed more recently; fits for B<sub>4</sub>-B<sub>9</sub> as described in N. Gokul, A. J. Schultz, D. A. Kofke, "<a href='https://doi.org/10.1002/aic.17072'>Properties of supercritical N2, O2, CO2, and NH3 mixtures from the virial equation of state</a>", <span class='pubName'>AIChE J.</span> <span class='volume'>67</span>, e17072 (2021).</div>
                  <div class='citation' id='vapor-ref-Johnson'>EOS Citation: J. Johnson, J. Zollweg, and K. Gubbins, "<a href='https://doi.org/10.1080/00268979300100411'>The Lennard-Jones equation of state revisited</a>", <span class='pubName'>Mol. Phys.</span> <span class='volume'>78</span>, 591–618 (1993).</div>
                  <div class='citation' id='vapor-ref-Kolafa'>EOS Citation: J. Kolafa and I. Nezbeda, "<a href='https://doi.org/10.1016/0378-3812(94)80001-4'>The Lennard-Jones fluid: An accurate analytic and theoretically-based equation of state</a>", <span class='pubName'>Fluid Phase Equilib.</span> <span class='volume'>100</span>, 1 (1994).</div>
                  <div class='citation' id='vapor-ref-May'>EOS Citation: H.-O. May and P. Mausbach, "<a href='https://doi.org/10.1103/PhysRevE.85.031201'>Riemannian geometry study of vapor-liquid phase equilibria and supercritical behavior of the Lennard-Jones fluid</a>", <span class='pubName'>Phys. Rev. E</span> <span class='volume'>86</span>, 059905 (2012).</div>
                  <div class='citation' id='vapor-ref-Thol'>EOS Citation: M. Thol, G. Rutkai, A. K ̈oster, R. Lustig, R. Span, and J. Vrabec, "<a href='https://doi.org/10.1063/1.4945000'>Equation of state for the Lennard-Jones fluid</a>", <span class='pubName'>J. Phys. Chem. Ref. Data</span> <span class='volume'>45</span>, 023101 (2016).</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='parametersDiv-liquid' class='card mb-4'>
        <div id='headingParameters-liquid' class='card-header' role='tab'>
          <h2 class='h5 mb-0'><a role='button' data-bs-toggle='collapse' href='#collapseparametersDiv-liquid' aria-expanded='true' aria-controls='colapseparametersDiv-liquid'>Liquid Parameters</a></h2>
        </div>
        <div id='collapseparametersDiv-liquid' class='collapse show' role='tabpanel' aria-labelledby='headingParameters-liquid'>
          <div class='card-body'>
            <div class='row'>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputEOS-liquid' class='col-form-label'>EOS</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputEOS-liquid' onchange='phaseChoiceUpdated("liquid")'>
                      <option value='Schultz' selected>Schultz</option>
                      <option value='Johnson'>Johnson</option>
                      <option value='Kolafa'>Kolafa</option>
                      <option value='May'>May</option>
                      <option value='Thol'>Thol</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputNl' class='col-form-label' data-bs-toggle="tooltip" data-bs-placement="top" title="# of atoms used for molecular simulations"># of atoms</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputNl'>
                      <option value='0' selected>&infin;</option>
                      <option value='4000'>4000</option>
                      <option value='2000'>2000</option>
                      <option value='1000'>1000</option>
                      <option value='500'>500</option>
                      <option value='250'>250</option>
                    </select>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='rc-liquid' class='col-form-label' data-bs-toggle="tooltip" data-bs-placement="top" data-bs-html="true" title="use EOS for the given scaled potential truncation (r<sub>c</sub> &rho;<sup>-1/3</sup>); can be corrected by long-range correction (LRC)">cutoff</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputRc-liquid'>
                      <option value='-1' selected>&infin;</option>
                      <option value='9'>9</option>
                      <option value='8'>8</option>
                      <option value='7'>7</option>
                      <option value='6'>6</option>
                      <option value='5'>5</option>
                      <option value='4'>4</option>
                      <option value='3'>3</option>
                      <option value='2'>2</option>
                      <option value='1'>1</option>
                      <option value='0'>0</option>
                    </select>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkLRC-liquid'>
                    <label class='form-check-label' for='checkLRC-liquid' data-bs-toggle="tooltip" data-bs-placement="right" title="Include standard long-range correction for potential truncation">include LRC</label>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='citation' id='liquid-ref-Schultz'>EOS Citation: A. J. Schultz, D. A. Kofke, "<a href='https://doi.org/10.1063/1.5053714'>Comprehensive high-precision high-accuracy equation of state and coexistence properties for classical Lennard-Jones crystals and low-temperature fluid phases</a>", <span class='pubName'>J. Chem. Phys.</span> <span class='volume'>149</span>, 204508 (2018).</div>
                  <div class='citation' id='liquid-ref-Johnson'>EOS Citation: J. Johnson, J. Zollweg, and K. Gubbins, "<a href='https://doi.org/10.1080/00268979300100411'>The Lennard-Jones equation of state revisited</a>", <span class='pubName'>Mol. Phys.</span> <span class='volume'>78</span>, 591–618 (1993).</div>
                  <div class='citation' id='liquid-ref-Kolafa'>EOS Citation: J. Kolafa and I. Nezbeda, "<a href='https://doi.org/10.1016/0378-3812(94)80001-4'>The Lennard-Jones fluid: An accurate analytic and theoretically-based equation of state</a>", <span class='pubName'>Fluid Phase Equilib.</span> <span class='volume'>100</span>, 1 (1994).</div>
                  <div class='citation' id='liquid-ref-May'>EOS Citation: H.-O. May and P. Mausbach, "<a href='https://doi.org/10.1103/PhysRevE.85.031201'>Riemannian geometry study of vapor-liquid phase equilibria and supercritical behavior of the Lennard-Jones fluid</a>", <span class='pubName'>Phys. Rev. E</span> <span class='volume'>86</span>, 059905 (2012).</div>
                  <div class='citation' id='liquid-ref-Thol'>EOS Citation: M. Thol, G. Rutkai, A. K ̈oster, R. Lustig, R. Span, and J. Vrabec, "<a href='https://doi.org/10.1063/1.4945000'>Equation of state for the Lennard-Jones fluid</a>", <span class='pubName'>J. Phys. Chem. Ref. Data</span> <span class='volume'>45</span>, 023101 (2016).</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>


    <div id='resultsDiv' class='card'>
      <div id='headingResults' class='card-header' role='tab'>
        <h2 class='h5 mb-0' style='float: left'>Results</h2>
        <button class='btn btn-info btn-sm' style='float: right' onclick='copyToClipboard(copyText)'>Copy</button>
        <button class='btn btn-info btn-sm' style='margin-right: 1rem; float: right' id='plotBtn' data-bs-toggle="modal" data-bs-target="#plotModal">Plot</button>
    </div>
    <div class='show' aria-labelledby='headingResults'>
      <div class='card-body'>
        <table class='table table-sm'>
          <thead><tr><th>T</th><th>&rho;1</th><th>&rho;2</th><th>P</th><th>G</th></tr></thead>
          <tbody id='coex-table'></tbody>
        </table>
      </div>
        </div>
      </div>
    </div>
    <script src='emscripten.js'></script>
    <script async type="text/javascript" src="virial.js"></script>

    <div class="modal fade" id="plotModal" tabindex="-1" aria-labelledby="plotModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="plotModalLabel">Plot</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div id="plotDiv"></div>
            <div class='row'>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputXprop' class='col-form-label'>X:</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputXprop' onchange='myUpdatePlot()'>
                      <option value='T'>T</option>
                      <option value='rho' selected>&rho;</option>
                      <option value='P'>P</option>
                      <option value='U'>U</option>
                      <option value='A'>A</option>
                      <option value='G'>G</option>
                      <option value='Z'>Z</option>
                      <option value='Cv'>Cv</option>
                      <option value='phi'>&phi;</option>
                      <option value='alpha'>&alpha;</option>
                      <option value='v2'>v2</option>
                      <option value='Y'>Y</option>
                      <option value='H'>H</option>
                      <option value='S'>S</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputYprop' class='col-form-label'>Y:</label>
                  </div>
                  <div class='col-auto'>
                    <select class='form-select' id='inputYprop' onchange='myUpdatePlot()'>
                      <option value='T'>T</option>
                      <option value='rho'>&rho;</option>
                      <option value='P' selected>P</option>
                      <option value='U'>U</option>
                      <option value='A'>A</option>
                      <option value='G'>G</option>
                      <option value='Z'>Z</option>
                      <option value='Cv'>Cv</option>
                      <option value='phi'>&phi;</option>
                      <option value='alpha'>&alpha;</option>
                      <option value='v2'>v2</option>
                      <option value='Y'>Y</option>
                      <option value='H'>H</option>
                      <option value='S'>S</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='plotXDiff' onchange='myUpdatePlot()'>
                    <label class='form-check-label' for='plotXDiff' data-bs-toggle="tooltip" data-bs-placement="right" title="Plot a single set as the value for phase2 - phase1 instead of separate sets">X diff</label>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='plotYDiff' onchange='myUpdatePlot()'>
                    <label class='form-check-label' for='plotXDiff' data-bs-toggle="tooltip" data-bs-placement="right" title="Plot a single set as the value for phase2 - phase1 instead of separate sets">Y diff</label>
                  </div>
                </div>
              </div>
            </div>
            <div class='row'>
              <div class='col-auto px-4' style='display: none;' id='SLE-Tmax-div'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputTMax' class='col-form-label'>T<sub>max</sub></label>
                  </div>
                  <div class='col-auto'>
                    <input type='text' id='inputTMax' class='form-control' value='2' style='width: 4rem;' onchange='myUpdatePlot()'>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4' style='display: none;' id='SLE-rhomax-div'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputRhoMax' class='col-form-label'>&rho;<sub>max</sub></label>
                  </div>
                  <div class='col-auto'>
                    <input type='text' id='inputRhoMax' class='form-control' value='1.5' style='width: 4rem;' onchange='myUpdatePlot()'>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4' style='display: none;' id='tie-lines-div'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputNTieLines' class='col-form-label' data-bs-toggle="tooltip" data-bs-placement="bottom" title="tie lines will be drawn between coexisting points"># tie lines</label>
                  </div>
                  <div class='col-auto'>
                    <input type='text' id='inputNTieLines' class='form-control' value='0' style='width: 3rem;' onchange='myUpdatePlot()'>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="infoCoexCurveModal" tabindex="-1" aria-labelledby="infoCoexCurveModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="infoCoexCurveModalLabel">EOS Coexistence Curve Info</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <p>The EOS coexistence curve pages allows you to construct a coexistence curve for two phases.  You can choose the EOS (and any EOS parameters) to use to generate thermodynamic properties for each phase.  Each page understands how to step through temperatures to construct the full curve and uses estimates of pressure from the result of the previous temperature.</p>
            <p>The coexistence densities, pressure and Gibbs free energy are reported for each temperature in the results table.  You may copy the data as comma-separated data and also open a plot.  For the plot, you can choose the properties plotted for the x and y axes.  If the chosen properties are the same for the two phases (T, P or G), then only a single set is plotted.  If one is different for the two phases, the a separate curve is shown for each phase.  Alternatively, you may choose to plot the difference in such a property to collapse back to a single curve.</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="infoVaporLiquidCoexModal" tabindex="-1" aria-labelledby="infoVaporLiquidCoexModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="infoVaporLiquidCoexModalLabel">Vapor-Liquid Coexistence Info</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <p>The Lennard-Jones vapor and liquid phases are in equilibrium starting at the vapor-liquid-FCC triple point and terminating a critical point.  This page starts below the triple point temperature, where the liquid is metastable and traces the curve until terminating at the specified T<sub>max</sub>.  The default T<sub>max</sub> is 0.9, beyond which the Schultz EOS for the liquid is not valid.  Use of a different liquid EOS allows you to follow the curve to higher temperature.  The script may have trouble finding coexistence near the critical point.</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>

  </body>
</html>
