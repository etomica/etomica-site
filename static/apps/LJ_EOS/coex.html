<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>LJ EOS for FCC</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <link href='main.css' rel='stylesheet'>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/brython@3.10.3/brython.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/brython@3.10.3/brython_stdlib.js"></script>
  </head>
  <body onload='brython()'>
    <script type='text/javascript'>
      function updateRhoP() {
        var rhoForP = document.getElementById("checkP").checked;
        var d = rhoForP ? "Rho" : "P";
        var e = rhoForP ? "P" : "Rho";
        document.getElementById("input"+d).setAttribute("disabled", "true");
        document.getElementById("input"+e).removeAttribute("disabled");
      }
      window.addEventListener("load", updateRhoP);
    </script>
    <script type='text/python' src='LJ_EOS.py'></script>
    <script type='text/python'>
      from browser import document
      from browser.widgets.dialog import InfoDialog
      from LJ_EOS import getEOS

      def update(ev):
        opts = []
        if document["checkLat"].checked:
          opts.append(("--lattice",""))
        elif document["checkHarmonic"].checked:
          opts.append(("--harmonic",""))
        if document["checkSS"].checked:
          opts.append(("--ss",""))
        doPhi = document["checkVac"].checked
        if doPhi:
          opts.append(("--vac",""))
        doNrcc = document["checkNrcc"].checked
        doLRC = document["checkLRC"].checked
        if doNrcc and doLRC:
          InfoDialog("Trouble", f"Cannot apply LRC to anharmonic")
          return
        if doLRC:
          opts.append(("--lrc",""))
        Nf = document["inputNf"].value
        if Nf != "0":
          if doNrcc:
            opts.append(("--Nfc",Nf))
          else:
            opts.append(("--Nf",Nf))
        rc = document["inputRc"].value
        if rc != "0":
          if doNrcc:
            opts.append(("--rcc",rc))
          else:
            opts.append(("--rc",rc))
          if Nf == "0":
            InfoDialog("Trouble", f"Must use a finite system size to truncate")
            return
        elif Nf != "0":
          InfoDialog("Trouble", f"Must truncate when using a finite system size")
          return
        elif doLRC:
          InfoDialog("Trouble", f"Must truncate to include LRC")
          return
        eos = getEOS('fcc', opts)
        T = document['inputT'].value
        if not T.isnumeric():
          InfoDialog("Trouble", f"Must provide a valid temperature")
          return
        T = float(T)
        if document["checkP"].checked:
          P = document['inputP'].value
          if not P.isnumeric():
            InfoDialog("Trouble", f"Must provide a valid pressure")
            return
          P = float(P)
          rho = eos.rhoForProps(T, {'P': P})
        elif document["checkNrho"].checked:
          if not doPhi:
            InfoDialog("Trouble", f"Need to have vacancies to do atom (instead of lattice) density")
            return
          rho = document['inputRho'].value
          if not rho.isnumeric():
            InfoDialog("Trouble", f"Must provide a valid density")
            return
          rho = float(rho)
          rho = eos.latRhoForNRho(T, rho)
        else:
          rho = document['inputRho'].value
          if not rho.isnumeric():
            InfoDialog("Trouble", f"Must provide a valid density")
            return
          rho = float(rho)
        props = eos.eval(T,rho)
        document['T'].textContent = T
        document['rho'].textContent = rho
        for p in props:
          document[p].textContent = props[p]
        if not doPhi:
          document["phi"].textContent = ""

      document["btnUpdate"].bind("click", update)
    </script>
    <div class='container'>
      <h1>Equation of State for FCC phase of LJ</h1>
      <div id='parametersDiv' class='card mb-4'>
        <div id='headingParameters' class='card-header' role='tab'>
          <h2 class='h5 mb-0'>Parameters</a></h2>
        </div>
        <div class='show' aria-labelledby='headingParameters'>
          <div class='card-body'>
            <div class='row'>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputT' class='col-form-label'>T</label>
                  </div>
                  <div class='col-auto'>
                    <input type='text' id='inputT' class='form-control'>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputRho' class='col-form-label'>&rho;</label>
                  </div>
                  <div class='col-auto'>
                    <input type='text' id='inputRho' class='form-control'>
                  </div>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkNrho'>
                    <label class='form-check-label' for='checkNrho'>atom density</label>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto'>
                    <label for='inputP' class='col-form-label'>P</label>
                  </div>
                  <div class='col-auto'>
                    <input type='text' id='inputP' class='form-control' disabled>
                  </div>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkP' onclick='updateRhoP()'>
                    <label class='form-check-label' for='checkP'>compute &rho; for P</label>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkLat'>
                    <label class='form-check-label' for='checkLat'>lattice properties</label>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkHarmonic'>
                    <label class='form-check-label' for='checkHarmonic'>lattice+harmonic properties</label>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkSS'>
                    <label class='form-check-label' for='checkSS'>soft-sphere properties</label>
                  </div>
                </div>
                <div class='row g-3 py-1 align-items-center'>
                  <div class='col-auto' class=form-check'>
                    <input class='form-check-input' type='checkbox' value='' id='checkVac'>
                    <label class='form-check-label' for='checkVac'>include vacancies</label>
                  </div>
                </div>
              </div>
              <div class='col-auto px-4'>
                <div class='row g-3 py-1 align-items-center'>
              <div class='col-auto'>
                <label for='inputNf' class='col-form-label'># of atoms</label>
              </div>
              <div class='col-auto'>
                <select class='form-select' id='inputNf'>
                  <option value='0' selected>&infin;</option>
                  <option value='4000'>4000</option>
                  <option value='2048'>2048</option>
                  <option value='864'>864</option>
                  <option value='500'>500</option>
                  <option value='256'>256</option>
                </select>
              </div>
            </div>
            <div class='row g-3 py-1 align-items-center'>
              <div class='col-auto'>
                <label for='rc' class='col-form-label'>cutoff</label>
              </div>
              <div class='col-auto'>
                <select class='form-select' id='inputRc'>
                  <option value='0' selected>&infin;</option>
                  <option value='11'>11</option>
                  <option value='9'>9</option>
                  <option value='7.5'>7.5</option>
                  <option value='6'>6</option>
                  <option value='5'>5</option>
                  <option value='4'>4</option>
                  <option value='3.5'>3.5</option>
                  <option value='3'>3</option>
                </select>
              </div>
            </div>
            <div class='row g-3 py-1 align-items-center'>
              <div class='col-auto' class=form-check'>
                <input class='form-check-input' type='checkbox' value='' id='checkNrcc'>
                <label class='form-check-label' for='checkNrcc'>apply only to anharmonic</label>
              </div>
            </div>
            <div class='row g-3 py-1 align-items-center'>
              <div class='col-auto' class=form-check'>
                <input class='form-check-input' type='checkbox' value='' id='checkLRC'>
                <label class='form-check-label' for='checkLRC'>include LRC</label>
              </div>
            </div>
          </div>
        </div>
        <div class='row g-3 py-1 align-items-center'>
              <div class='col-auto'>
                <button id='btnUpdate' class='btn btn-sm btn-primary' type='button'>Update</button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='resultsDiv' class='card'>
        <div id='headingResults' class='card-header' role='tab'>
          <h2 class='h5 mb-0'>Results</a></h2>
        </div>
        <div class='show' aria-labelledby='headingResults'>
          <div class='card-body'>
            T: <span id='T'></span><br>
            &rho;: <span id='rho'></span><br>
            P: <span id='P'></span><br>
            U: <span id='U'></span><br>
            A: <span id='A'></span><br>
            G: <span id='G'></span><br>
            Z: <span id='Z'></span><br>
            dZdrho: <span id='dZdrho'></span><br>
            dPdrho: <span id='dPdrho'></span><br>
            dGdrho: <span id='dGdrho'></span><br>
            Cv: <span id='Cv'></span><br>
            vacancy fraction: <span id='phi'></span><br>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
